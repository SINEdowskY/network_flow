Ten kod implementuje algorytm Forda-Fulkersona do znajdowania maksymalnego przepływu w grafie.

Funkcja ford_fulkerson przyjmuje graf G, wierzchołek źródłowy source i wierzchołek ujściowy sink jako argumenty. Algorytm zaczyna od ustawienia początkowego przepływu na każdej krawędzi grafu na zero.

Następnie algorytm wykonuje się w pętli, dopóki istnieje ścieżka od źródła do ujścia w grafie. Wykorzystuje funkcję bfs do znalezienia takiej ścieżki. Jeśli żadna ścieżka nie istnieje, oznacza to, że nie ma już możliwości zwiększenia przepływu w grafie i algorytm kończy działanie.

Jeśli istnieje ścieżka od źródła do ujścia, algorytm znajduje minimalną pojemność krawędzi na tej ścieżce (czyli minimalny przepustowość) poprzez iterowanie po krawędziach na ścieżce i sprawdzanie minimalnej różnicy między pojemnością krawędzi a obecnym przepływem.

Następnie algorytm aktualizuje przepływ wzdłuż ścieżki, dodając minimalną pojemność do przepływu na krawędziach w kierunku przodu i odejmując minimalną pojemność od przepływu na krawędziach w kierunku wstecznym.

Po zakończeniu pętli algorytm oblicza całkowity przepływ poprzez zsumowanie wartości przepływu na wszystkich krawędziach.

Funkcja bfs implementuje algorytm przeszukiwania wszerz (BFS) w celu znalezienia ścieżki od źródła do ujścia. Tworzy listę odwiedzonych wierzchołków i ścieżek. Algorytm inicjalizuje listę visited, w której wszystkie wierzchołki mają wartość False, z wyjątkiem wierzchołka źródłowego, który ma wartość True.

Następnie algorytm rozpoczyna BFS od wierzchołka źródłowego, dodaje go do kolejki queue i oznacza jako odwiedzony. Następnie iteruje po sąsiadach bieżącego wierzchołka u i sprawdza, czy sąsiad jest nieodwiedzony i czy ma niezerową przepustowość.

Jeśli sąsiad jest nieodwiedzony i ma niezerową przepustowość, oznacza go jako odwiedzonego, aktualizuje ścieżkę do tego sąsiada, dodaje go do kolejki queue i kontynuuje przeszukiwanie BFS.

Jeśli algorytm dotrze do wierzchołka ujścia, zwraca ścieżkę od źródła do ujścia. W przeciwnym razie zwraca None, co oznacza, że nie istnieje ścieżka od źródła do ujścia.




